(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{531:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"web-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web-api"}},[t._v("#")]),t._v(" Web Api")]),t._v(" "),s("h2",{attrs:{id:"一、intersection-observer-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、intersection-observer-api"}},[t._v("#")]),t._v(" 一、Intersection Observer Api")]),t._v(" "),s("h3",{attrs:{id:"_1-intersectionobserver"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-intersectionobserver"}},[t._v("#")]),t._v(" 1.IntersectionObserver")]),t._v(" "),s("p",[s("code",[t._v("IntersectionObserver")]),t._v(" 接口（从属于 "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API",target:"_blank",rel:"noopener noreferrer"}},[t._v("Intersection Observer API"),s("OutboundLink")],1),t._v("）")]),t._v(" "),s("p",[t._v("提供了一种异步观察"),s("strong",[t._v("目标元素与其祖先元素或顶级文档交叉状态的方法")]),t._v("。其祖先元素或视口被称为根（root）。")]),t._v(" "),s("p",[t._v("此Api可用于以下场景")]),t._v(" "),s("ul",[s("li",[t._v("图片懒加载——当图片滚动到可见时才进行加载")]),t._v(" "),s("li",[t._v("内容无限滚动——也就是用户滚动到接近内容底部时直接加载更多，而无需用户操作翻页，给用户一种网页可以无限滚动的错觉")]),t._v(" "),s("li",[t._v("检测广告的曝光情况——为了计算广告收益，需要知道广告元素的曝光情况")]),t._v(" "),s("li",[t._v("在用户看见某个区域时执行任务或播放动画")])]),t._v(" "),s("h4",{attrs:{id:"_1-1-基本语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-基本语法"}},[t._v("#")]),t._v(" 1.1 基本语法")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ob "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ob "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("observer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 回调函数逻辑")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"_1-2-参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-参数"}},[t._v("#")]),t._v(" 1.2 参数")]),t._v(" "),s("p",[s("strong",[t._v("callback")]),t._v("：当元素可见比例超过指定阈值后，会调用一个回调函数，此回调函数接受两个参数：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("entries")]),t._v("：一个"),s("code",[t._v("IntersectionObserverEntry")]),t._v("对象的数组，每个被触发的阈值，都或多或少与指定阈值有偏差。具体属性值查看下面IntersectionObserverEntry实例属性")]),t._v(" "),s("li",[s("strong",[t._v("observer")]),t._v("：被调用的"),s("code",[t._v("IntersectionObserver")]),t._v("实例。")])]),t._v(" "),s("p",[s("strong",[t._v("options")]),t._v("：可选，一个可以用来配置 observer 实例的对象。如果"),s("code",[t._v("options")]),t._v("未指定，observer 实例默认使用文档视口作为 root，并且没有 margin，阈值为 0%（意味着即使一像素的改变都会触发回调函数）。你可以指定以下配置：")]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("root")]),t._v("："),s("strong",[t._v("监听元素的祖先dom元素")]),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Element",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("Element")]),s("OutboundLink")],1),t._v("对象，其边界盒将被视作视口。目标在根的可见区域的的任何不可见部分都会被视为不可见。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("rootMargin")]),t._v("："),s("strong",[t._v("可以扩大或缩小目标元素与根元素重叠面积的判定范围")])]),t._v(" "),s("ul",[s("li",[t._v("语法大致和 CSS 中的"),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/CSS/margin",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("margin")]),s("OutboundLink")],1),t._v(" 属性等同; 可以参考 "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API#the_intersection_root_and_root_margin",target:"_blank",rel:"noopener noreferrer"}},[t._v("intersection root 和 root margin"),s("OutboundLink")],1),t._v(" 来深入了解 margin 的工作原理及其语法。")]),t._v(" "),s("li",[t._v('默认值是"0px 0px 0px 0px"。')]),t._v(" "),s("li",[t._v("例如，当threshold=0，给目标元素添加了100px的rootMargin，则原本目标元素与根元素有1px的重合就会触发回调函数，现在目标元素与根元素相聚100px时就会触发回调")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("threshold")]),t._v("：规定了"),s("strong",[t._v("一个监听目标元素与根元素交叉区域的比例值")])]),t._v(" "),s("ul",[s("li",[t._v("可以是一个具体的数值或是一组 0.0 到 1.0 之间的数值。")]),t._v(" "),s("li",[t._v("若指定值为 0.0，则意味着监听元素即使与根有 1 像素交叉，此元素也会被视为可见。")]),t._v(" "),s("li",[t._v("若指定值为 1.0，则意味着整个元素都在可见范围内时才算可见。")]),t._v(" "),s("li",[t._v("可以参考"),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API#thresholds",target:"_blank",rel:"noopener noreferrer"}},[t._v("阈值"),s("OutboundLink")],1),t._v("来深入了解阈值是如何使用的。阈值的默认值为 0.0。")])])])]),t._v(" "),s("h4",{attrs:{id:"_1-3-实例属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-实例属性"}},[t._v("#")]),t._v(" 1.3 实例属性")]),t._v(" "),s("h5",{attrs:{id:"_1-3-1-root"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-root"}},[t._v("#")]),t._v(" 1.3.1 root")]),t._v(" "),s("p",[s("code",[t._v("root")]),t._v(" 属性用来获取当前 "),s("code",[t._v("intersectionObserver")]),t._v(" 实例的根元素。")]),t._v(" "),s("h5",{attrs:{id:"_1-3-2-rootmargin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-rootmargin"}},[t._v("#")]),t._v(" 1.3.2 rootMargin")]),t._v(" "),s("p",[t._v("只读属性 "),s("strong",[s("code",[t._v("rootMargin")])]),t._v(" 是与 CSS 属性"),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/CSS/margin",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("margin")]),s("OutboundLink")],1),t._v("语法相似的字符串 (string) 对象。在交叉检测开始之前，由"),s("code",[t._v("rootMargin 规定的矩形的每一边都会被添加至")]),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver/root",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("root")]),s("OutboundLink")],1),t._v("元素的边框盒 ("),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Glossary/Bounding_box",target:"_blank",rel:"noopener noreferrer"}},[t._v("bounding box (en-US)"),s("OutboundLink")],1),t._v(") 的相应边。例如，这可以让你向外调整边界，使得目标元素被认为是 100% 可见的，即使此元素得一部分长或宽被裁剪，或者在边缘过于靠近根边框盒边界的情况下，将目标视为部分隐藏。")]),t._v(" "),s("p",[t._v("设置方法和css设置margin一致")]),t._v(" "),s("h5",{attrs:{id:"_1-3-3-thresholds"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-thresholds"}},[t._v("#")]),t._v(" 1.3.3 thresholds")]),t._v(" "),s("p",[t._v("只读阈值属性返回在使用 "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver/IntersectionObserver",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("IntersectionObserver（）")]),s("OutboundLink")],1),t._v(" 实例化观察器时指定的交集**"),s("code",[t._v("阈值")]),t._v("**列表。如果在实例化对象时仅提供一个阈值比率，这将是一个包含该单个值的数组。")]),t._v(" "),s("h4",{attrs:{id:"_1-4-实例方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-实例方法"}},[t._v("#")]),t._v(" 1.4 实例方法")]),t._v(" "),s("h5",{attrs:{id:"_1-4-1-disconnect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-disconnect"}},[t._v("#")]),t._v(" 1.4.1 disconnect()")]),t._v(" "),s("p",[s("strong",[t._v("作用")]),t._v("：终止对所有目标元素可见性变化的观察。")]),t._v(" "),s("p",[s("strong",[t._v("语法")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ob "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("disconnect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h5",{attrs:{id:"_1-4-2-observe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-observe"}},[t._v("#")]),t._v(" 1.4.2 observe()")]),t._v(" "),s("p",[s("strong",[t._v("作用")]),t._v("：向 IntersectionObserver 对象监听的目标集合添加一个dom元素。")]),t._v(" "),s("p",[s("strong",[t._v("语法")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ob "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"elementToObserve"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h5",{attrs:{id:"_1-4-3-unobserve"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-unobserve"}},[t._v("#")]),t._v(" 1.4.3  unobserve()")]),t._v(" "),s("p",[t._v("命令"),s("code",[t._v("IntersectionObserver")]),s("strong",[t._v("停止对一个元素的观察")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ob "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"elementToObserve"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* ... */")]),t._v("\n\nob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unobserve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"elementToObserve"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-intersectionobserverentry"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-intersectionobserverentry"}},[t._v("#")]),t._v(" 2.IntersectionObserverEntry")]),t._v(" "),s("p",[s("code",[t._v("IntersectionObserverEntry 接口")]),t._v(" (从属于 "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API",target:"_blank",rel:"noopener noreferrer"}},[t._v("Intersection Observer API"),s("OutboundLink")],1),t._v(" ) "),s("strong",[t._v("描述了目标元素与其根元素容器在某一特定过渡时刻的交叉状态。")])]),t._v(" "),s("p",[s("code",[t._v("IntersectionObserverEntry")]),t._v(" 的实例作为 "),s("code",[t._v("entries")]),t._v(" 参数被传递到一个 "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("IntersectionObserver")]),s("OutboundLink")],1),t._v(" 的回调函数中; 此外，这些对象只能通过调用"),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver/takeRecords",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("IntersectionObserver.takeRecords()")]),s("OutboundLink")],1),t._v(" 来获取。")]),t._v(" "),s("h4",{attrs:{id:"_2-1-实例属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-实例属性"}},[t._v("#")]),t._v(" 2.1 实例属性")]),t._v(" "),s("h5",{attrs:{id:"_2-1-1-boundingcientrect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-boundingcientrect"}},[t._v("#")]),t._v(" 2.1.1 boundingCientRect")]),t._v(" "),s("p",[t._v("只读属性，返回一个"),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/DOMRect",target:"_blank",rel:"noopener noreferrer"}},[t._v("DOMRect"),s("OutboundLink")],1),t._v("对象，该属性实质上描述了一个描述 包含整个目标元素的最小矩形。")]),t._v(" "),s("p",[t._v("包含此dom元素的left、right、top、bottom、width、height、x、y属性")]),t._v(" "),s("h5",{attrs:{id:"_2-1-2-intersectionratio"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-2-intersectionratio"}},[t._v("#")]),t._v(" 2.1.2 intersectionRatio")]),t._v(" "),s("p",[t._v("返回观察元素与根元素面积面积相交的比率，值在"),s("strong",[t._v("0.0~1.0")]),t._v("之间")]),t._v(" "),s("ul",[s("li",[t._v("若目标元素与根元素一点都不相交，则为0")]),t._v(" "),s("li",[t._v("若目标元素与根元素完全相交，则为1")])]),t._v(" "),s("h5",{attrs:{id:"_2-1-3-intersectionrect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-intersectionrect"}},[t._v("#")]),t._v(" 2.1.3 intersectionRect")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserverEntry",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("IntersectionObserverEntry")]),s("OutboundLink")],1),t._v(" 接口的 read-only "),s("strong",[s("code",[t._v("intersectionRect")])]),t._v(" 属性是一个 "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/DOMRectReadOnly",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("DOMRectReadOnly")]),s("OutboundLink")],1),t._v(" 对象，它描述最小的矩形 包含当前在 中可见的目标元素的整个部分 交集根。")]),t._v(" "),s("h5",{attrs:{id:"_2-1-4-isintersecting-重要"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-4-isintersecting-重要"}},[t._v("#")]),t._v(" 2.1.4 isIntersecting（重要）")]),t._v(" "),s("p",[t._v("只读属性，"),s("strong",[t._v("目标元素与根元素是否相交")]),t._v("，返回"),s("strong",[t._v("布尔值")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ob "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" observe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" entries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isIntersecting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'目标元素与根元素已相交'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                ob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unobserve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("threshold")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h5",{attrs:{id:"_2-1-5-target"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-5-target"}},[t._v("#")]),t._v(" 2.1.5 target")]),t._v(" "),s("p",[t._v("指定目标元素的dom元素，与document.querySelector获取的一样")]),t._v(" "),s("p",[t._v("可通过target属性设置dom元素的样式、标签属性等")]),t._v(" "),s("h5",{attrs:{id:"_2-1-6-time"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-6-time"}},[t._v("#")]),t._v(" 2.1.6 time")]),t._v(" "),s("p",[t._v("目标元素与根元素相交的时间，ms为单位")]),t._v(" "),s("h3",{attrs:{id:"_3-实现图片懒加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-实现图片懒加载"}},[t._v("#")]),t._v(" 3.实现图片懒加载")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ob "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entires")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" entry "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" entires"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isIntersecting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" img"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target\n                img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dataset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src\n                ob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unobserve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("threshold")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" imgs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelectorAll")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'img[data-src]'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nimgs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    ob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"二、page-visibility-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、page-visibility-api"}},[t._v("#")]),t._v(" 二、Page Visibility Api")]),t._v(" "),s("p",[t._v("页面可见性 API，"),s("strong",[t._v("可以监听当前页面是否可见")])]),t._v(" "),s("p",[t._v("本Api分为两个属性：hidden、visibilityState；和一个事件：visibilitychange")]),t._v(" "),s("h3",{attrs:{id:"_1-属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-属性"}},[t._v("#")]),t._v(" 1.属性")]),t._v(" "),s("h4",{attrs:{id:"_1-1-document-hidden"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-document-hidden"}},[t._v("#")]),t._v(" 1.1 document.hidden")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("Document.hidden")])]),t._v(" （只读属性）返回布尔值，表示页面是（true）否（false）隐藏。")]),t._v(" "),s("p",[t._v("语法：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" string "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hidden\n")])])]),s("p",[t._v("兼容性")]),t._v(" "),s("ul",[s("li",[t._v("IE浏览器中：mshidden，")]),t._v(" "),s("li",[t._v("老版本谷歌中：webkithidden")])]),t._v(" "),s("h4",{attrs:{id:"_1-2-document-visibilitystate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-document-visibilitystate"}},[t._v("#")]),t._v(" 1.2 document.visibilityState")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("Document.visibilityState")])]),t._v(" （只读属性）, "),s("strong",[t._v("返回document的可见性")]),t._v("，即当前可见元素的上下文环境。由此可以知道当前文档 (即为页面) 是在背后，或是不可见的隐藏的标签页，或者 (正在) 预渲染。可用的值如下：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("visible")]),t._v(" : 此时页面内容"),s("strong",[t._v("至少是部分可见")]),t._v("。即此页面在前景标签页中，并且窗口没有最小化。")]),t._v(" "),s("li",[s("strong",[t._v("hidden")]),t._v(" : 此时页面对用户"),s("strong",[t._v("不可见")]),t._v("。即文档处于背景标签页或者窗口处于最小化状态，或者操作系统正处于 '锁屏状态' .")]),t._v(" "),s("li",[s("strong",[t._v("prerender")]),t._v(" : 页面此时"),s("strong",[t._v("正在渲染中")]),t._v("，因此是不可见的 (considered hidden for purposes of "),s("code",[t._v("document.hidden")]),t._v("). 文档只能从此状态开始，永远不能从其他值变为此状态。注意：浏览器支持是可选的。")])]),t._v(" "),s("p",[t._v("语法：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" string "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("visibilityState\n")])])]),s("p",[t._v("当"),s("code",[t._v("visibilityState")]),t._v("改变时，会触发"),s("code",[t._v("visibilistchange")]),t._v("事件")]),t._v(" "),s("h3",{attrs:{id:"_2-事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-事件"}},[t._v("#")]),t._v(" 2.事件")]),t._v(" "),s("h4",{attrs:{id:"_2-1-visibilistchange"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-visibilistchange"}},[t._v("#")]),t._v(" 2.1 visibilistchange")]),t._v(" "),s("p",[t._v("当其选项卡的内容变得可见或被隐藏时，会在文档上触发 "),s("code",[t._v("visibilitychange")]),t._v(" (能见度更改) 事件。")]),t._v(" "),s("p",[t._v("语法：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"visibilitychange"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("visibilityState "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("兼容性")]),t._v(" "),s("ul",[s("li",[t._v("IE浏览器中：msvisibilitychange，")]),t._v(" "),s("li",[t._v("老版本谷歌中：webkitvisibilitychange")])]),t._v(" "),s("h2",{attrs:{id:"三、animation-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、animation-api"}},[t._v("#")]),t._v(" 三、Animation Api")]),t._v(" "),s("p",[t._v("CSS实现动画时，在一些交互动画上并不灵活，可以使用js的一套Animation Api来完成动画的制作")]),t._v(" "),s("h3",{attrs:{id:"_3-1-animate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-animate"}},[t._v("#")]),t._v(" 3.1 animate()")]),t._v(" "),s("h4",{attrs:{id:"_3-1-1-语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-语法"}},[t._v("#")]),t._v(" 3.1.1 语法：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("animate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("keyframs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[t._v("返回一个animation动画实例")])]),t._v(" "),s("h4",{attrs:{id:"_3-1-2-参数keyframs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-2-参数keyframs"}},[t._v("#")]),t._v(" 3.1.2 参数keyframs")]),t._v(" "),s("p",[s("strong",[t._v("作用")]),t._v("：用来"),s("strong",[t._v("定义动画的关键帧")])]),t._v(" "),s("p",[t._v("keyframes有两种形式，一种是数组形式，一种是对象形式。")]),t._v(" "),s("p",[t._v("关键帧的偏移可以通过提供一个"),s("code",[t._v("offset")]),t._v("来指定")]),t._v(" "),s("ul",[s("li",[t._v("值必须是在 "),s("strong",[t._v("[0.0, 1.0]")]),t._v(" 这个区间内，且须升序排列")]),t._v(" "),s("li",[s("strong",[t._v("简单理解就是进度的百分比的小数值。")])])]),t._v(" "),s("p",[s("strong",[t._v("数组形式")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("animate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("opacity")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("opacity")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("offset")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.7")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("opacity")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[s("strong",[t._v("对象形式")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("animate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("opacity")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("offset")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.8")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [ 0, 0.8, 1 ] 的简写")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("easing")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ease-in'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ease-out'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("以上写法与以下css写法一个意思")]),t._v(" "),s("div",{staticClass:"language-css extra-class"},[s("pre",{pre:!0,attrs:{class:"language-css"}},[s("code",[s("span",{pre:!0,attrs:{class:"token atrule"}},[s("span",{pre:!0,attrs:{class:"token rule"}},[t._v("@keyframes")]),t._v(" bling")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token selector"}},[t._v("0%")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("opacity")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token selector"}},[t._v("70%")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("opacity")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token selector"}},[t._v("100%")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("opacity")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_3-1-3-参数options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-3-参数options"}},[t._v("#")]),t._v(" 3.1.3 参数options")]),t._v(" "),s("p",[t._v("作用：对象类型，用来定义动画过程中可以有哪些操作，相当于css中的animation属性")]),t._v(" "),s("p",[t._v("其属性值与css各属性值相同"),s("a",{attrs:{href:"https://xarzhi.gitee.io/%E5%89%8D%E7%AB%AF%E4%B8%89%E5%89%91%E5%AE%A2/CSS/CSS3/05.%E5%8A%A8%E7%94%BB.html#_3-1-animation-name",target:"_blank",rel:"noopener noreferrer"}},[t._v("css动画常见属性"),s("OutboundLink")],1)]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("参数名")]),t._v(" "),s("th",[t._v("含义")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("delay")])]),t._v(" "),s("td",[t._v("延迟动画开始的毫秒数。默认为0。")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("direction")])]),t._v(" "),s("td",[t._v("动画运动方向")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("duration")])]),t._v(" "),s("td",[t._v("动画每次迭代完成所需的毫秒数。默认为0")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("easing")])]),t._v(" "),s("td",[t._v("动画曲线函数，可以自定义")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("endDelay")])]),t._v(" "),s("td",[t._v("动画结束后要延迟的毫秒数。这主要用于基于另一个动画的结束时间对动画进行排序。默认为0。")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("fill")])]),t._v(" "),s("td",[t._v("动画结束后属性值的状态")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("iterationStart")])]),t._v(" "),s("td",[t._v("描述动画应该在迭代的什么时候开始。0.5表示在第一次迭代中途开始，使用这个值集，一个有两次迭代的动画将在第三次迭代中途结束。默认为0.0")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("iterations")])]),t._v(" "),s("td",[t._v("动画应该重复的次数。默认值为1，也可以取一个值 Infinity，使其在元素存在期间重复。")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("composite")])]),t._v(" "),s("td",[t._v("动画和其他单独的动画之间组合。 这是个高级特性，默认是replace，就是替换提起的动画。")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("iterationComposite")])]),t._v(" "),s("td",[t._v("动画的属性值变化如何在每次动画迭代时累积或相互覆盖")])])])]),t._v(" "),s("p",[s("strong",[t._v("参照css属性")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Web Animation API")]),t._v(" "),s("th",[t._v("CSS")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("delay")]),t._v(" "),s("td",[t._v("animation-delay")])]),t._v(" "),s("tr",[s("td",[t._v("duration")]),t._v(" "),s("td",[t._v("animation-duration")])]),t._v(" "),s("tr",[s("td",[t._v("iterations")]),t._v(" "),s("td",[t._v("animation-iteration-count")])]),t._v(" "),s("tr",[s("td",[t._v("direction")]),t._v(" "),s("td",[t._v("animation-direction")])]),t._v(" "),s("tr",[s("td",[t._v("easing")]),t._v(" "),s("td",[t._v("animation-timing-function")])]),t._v(" "),s("tr",[s("td",[t._v("fill")]),t._v(" "),s("td",[t._v("animation-fill-mode")])])])]),t._v(" "),s("p",[s("strong",[t._v("注意参数设置值上的区别")])]),t._v(" "),s("ol",[s("li",[s("code",[t._v("duration")]),t._v(" 参数只支持毫秒")]),t._v(" "),s("li",[t._v("迭代次数无限使用的是 JS的"),s("code",[t._v("Infinity")]),t._v("，不是字符串 "),s("code",[t._v('"infinite"')])]),t._v(" "),s("li",[t._v("默认动画的贝塞尔是"),s("code",[t._v("linear")]),t._v("，而不是css的"),s("code",[t._v("ease")])])]),t._v(" "),s("h4",{attrs:{id:"_3-1-4-getanimations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-4-getanimations"}},[t._v("#")]),t._v(" 3.1.4 getAnimations()")]),t._v(" "),s("p",[t._v("我们通过Element.animate或者创建Animation给Element添加很多动画，通过这个方法可以"),s("strong",[t._v("获得所有Animation的实例")]),t._v("。"),s("strong",[t._v("以数组形式存放")])]),t._v(" "),s("p",[s("strong",[t._v("语法")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAnimations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("通常用来当取消前面已经播放过的动画实例")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAnimations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cancel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-2-动画实例方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-动画实例方法"}},[t._v("#")]),t._v(" 3.2 动画实例方法")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("实例方法")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("cancel()")]),t._v(" "),s("td",[t._v("取消动画")])]),t._v(" "),s("tr",[s("td",[t._v("finish()")]),t._v(" "),s("td",[t._v("完成动画")])]),t._v(" "),s("tr",[s("td",[t._v("pause()")]),t._v(" "),s("td",[t._v("暂停动画")])]),t._v(" "),s("tr",[s("td",[t._v("paly()")]),t._v(" "),s("td",[t._v("播放动画")])]),t._v(" "),s("tr",[s("td",[t._v("reverse()")]),t._v(" "),s("td",[t._v("动画逆转播放")])])])]),t._v(" "),s("p",[t._v("语法：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" animate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ball"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("animate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("keyframs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nanimate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("play")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-3-事件监听"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-事件监听"}},[t._v("#")]),t._v(" 3.3 事件监听")]),t._v(" "),s("p",[t._v("Animation事件监听有两种方式，dom监听和promise监听")]),t._v(" "),s("h4",{attrs:{id:"_3-3-1-dom监听"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-dom监听"}},[t._v("#")]),t._v(" 3.3.1 dom监听")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("animation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onfinish")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nanimation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"finish"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_3-3-2-promise监听"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2-promise监听"}},[t._v("#")]),t._v(" 3.3.2 promise监听")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("animation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("finished"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n  element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("所有动画完成后")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" animates "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAnimations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nPromise"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("all")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("animates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ani")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" ani"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("finished"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("           \n    \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// do something cool ")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"_3-3-3-常用事件回调"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-3-常用事件回调"}},[t._v("#")]),t._v(" 3.3.3 常用事件回调")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("监听事件")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("oncancel")]),t._v(" "),s("td",[t._v("监听动画取消")])]),t._v(" "),s("tr",[s("td",[t._v("onfinish")]),t._v(" "),s("td",[t._v("监听动画完成")])]),t._v(" "),s("tr",[s("td",[t._v("onremove")]),t._v(" "),s("td",[t._v("监听动画删除")])])])]),t._v(" "),s("h3",{attrs:{id:"_3-4-keyframeeffect和animation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-keyframeeffect和animation"}},[t._v("#")]),t._v(" 3.4 KeyframeEffect和Animation")]),t._v(" "),s("p",[t._v("KeyframeEffect和Animation是web Animations API 两个核心的对象")]),t._v(" "),s("ol",[s("li",[t._v("KeyframeEffect 描述动画属性")]),t._v(" "),s("li",[t._v("Animation 控制播放")])]),t._v(" "),s("h4",{attrs:{id:"_3-4-1-keyframeeffect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-1-keyframeeffect"}},[t._v("#")]),t._v(" 3.4.1 KeyframeEffect")]),t._v(" "),s("p",[s("strong",[t._v("作用")]),t._v("：用来定义动画的关键帧")]),t._v(" "),s("p",[s("strong",[t._v("语法")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" keyframs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("KeyframeEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" keyframes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[t._v("参数")]),t._v("：")]),t._v(" "),s("ul",[s("li",[t._v("target：需要指定动画的dom元素")]),t._v(" "),s("li",[t._v("keyframes、options与上方3.1.2、3.1.3一致")])]),t._v(" "),s("h4",{attrs:{id:"_3-4-2-animation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-2-animation"}},[t._v("#")]),t._v(" 3.4.2 Animation")]),t._v(" "),s("p",[s("strong",[t._v("作用")]),t._v("：KeyframeEffect返回一个animation动画实例，由Animation对象实例来控制动画")]),t._v(" "),s("p",[s("strong",[t._v("语法")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" keyframs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("KeyframeEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" keyframes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ani "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Animation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("keyframs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nani"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("play")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nani"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pause")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n")])])]),s("p",[t._v("Animation 实例对象的方法与上方3.2一致")]),t._v(" "),s("p",[t._v("gsap：用空学https://gsap.framer.wiki/")]),t._v(" "),s("h2",{attrs:{id:"四、clipboard-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、clipboard-api"}},[t._v("#")]),t._v(" 四、Clipboard Api")]),t._v(" "),s("p",[t._v("剪贴板 Clipboard API 为 "),s("strong",[t._v("Navigator")]),t._v(" 接口添加了只读属性 "),s("code",[t._v("clipboard")]),t._v("，该属性返回一个"),s("strong",[t._v("可以读写剪切板内容")]),t._v("的 "),s("strong",[t._v("Clipboard")]),t._v(" 对象。 在 Web 应用中，剪切板 API 可用于实现剪切、复制、粘贴的功能。")]),t._v(" "),s("h3",{attrs:{id:"_4-1-实例方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-实例方法"}},[t._v("#")]),t._v(" 4.1 实例方法")]),t._v(" "),s("p",[s("code",[t._v("Clipboard Api")]),t._v("的实例方法在"),s("code",[t._v("navigator.clipboard")]),t._v("对象上")]),t._v(" "),s("h4",{attrs:{id:"_4-1-1-read"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-read"}},[t._v("#")]),t._v(" 4.1.1 read()")]),t._v(" "),s("p",[s("strong",[t._v("作用")]),t._v("："),s("strong",[t._v("请求获取剪贴板内容")]),t._v("，在解析承诺时将数据传递给返回的 "),s("strong",[t._v("Promise")]),t._v("。")]),t._v(" "),s("ul",[s("li",[t._v("与 "),s("code",[t._v("readText()")]),t._v(" 不同，该方法可以返回任意数据，例如图像。")])]),t._v(" "),s("p",[s("strong",[t._v("语法")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" promise "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"_4-1-2-readtext"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-readtext"}},[t._v("#")]),t._v(" 4.1.2 readText()")]),t._v(" "),s("p",[s("strong",[t._v("作用")]),t._v("：解析系统剪贴板的文本内容返回一个Promise")]),t._v(" "),s("ul",[s("li",[t._v("当剪切板有东西时，浏览器会首先请求获取剪切板内容")])]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("box"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" box "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('".box"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" p "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readText")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        box"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h4",{attrs:{id:"_4-1-3-write"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-3-write"}},[t._v("#")]),t._v(" 4.1.3 write()")]),t._v(" "),s("p",[s("strong",[t._v("作用")]),t._v("：写入"),s("strong",[t._v("图片等任意的数据")]),t._v("到剪贴板。这个方法可以用于实现剪切和复制的功能。")]),t._v(" "),s("p",[s("strong",[t._v("返回值")]),t._v("：当数据被写入到剪贴板的时候，"),s("strong",[t._v("Promise")]),t._v(" 的"),s("code",[t._v("resolve")]),t._v(" 回调被执行。如果剪贴板不能完成剪贴操作，"),s("strong",[t._v("Promise")]),t._v("的"),s("code",[t._v("reject")]),t._v(" 回调被执行。")]),t._v(" "),s("p",[s("strong",[t._v("语法")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" promise "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataTransfer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[t._v("示例")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setClipboard")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("text")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DataTransfer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/plain"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* success */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* failure */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"_4-1-4-writetext"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-4-writetext"}},[t._v("#")]),t._v(" 4.1.4 writeText()")]),t._v(" "),s("p",[s("strong",[t._v("作用")]),t._v("：可以写入特定"),s("strong",[t._v("字符串")]),t._v("到操作系统的剪切板。")]),t._v(" "),s("p",[s("strong",[t._v("返回值")]),t._v("：一个"),s("code",[t._v("Promise")]),t._v("，一旦剪贴板的内容被更新，它就会被解析。如果调用者没有写入剪贴板的权限，则拒绝写入剪切板（reject）")]),t._v(" "),s("p",[s("strong",[t._v("语法")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeText")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"内容"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'复制成功'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'复制失败'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-2-剪切板事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-剪切板事件"}},[t._v("#")]),t._v(" 4.2 剪切板事件")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("事件")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("oncopy")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("该事件在用户拷贝元素内容时触发")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("oncut")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("该事件在用户剪切元素内容时触发")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onpaste")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("该事件在用户粘贴元素内容时触发")])])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'copy'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户复制了内容'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cut'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户剪切了内容'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'paste'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户粘贴了内容'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"五、网络状态监控"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、网络状态监控"}},[t._v("#")]),t._v(" 五、网络状态监控")]),t._v(" "),s("h3",{attrs:{id:"_6-1-获取网络信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-获取网络信息"}},[t._v("#")]),t._v(" 6.1 获取网络信息")]),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("navigator.connection")]),t._v("可获取当前浏览器的网络状态")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("可以获取到以下信息")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("属性")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("downlink")]),t._v(" "),s("td",[t._v("返回以 "),s("strong",[t._v("Mb/s")]),t._v(" 为单位的"),s("strong",[t._v("有效带宽")])])]),t._v(" "),s("tr",[s("td",[t._v("effectiveType")]),t._v(" "),s("td",[t._v("当前网络类型，如2g,3g,4g")])]),t._v(" "),s("tr",[s("td",[t._v("onchange")]),t._v(" "),s("td",[t._v("网络状态发生变化时，触发相应回调")])]),t._v(" "),s("tr",[s("td",[t._v("rtt")]),t._v(" "),s("td",[t._v("返回了当前连接下评估的"),s("strong",[t._v("往返延迟")]),t._v("，也就是ping")])]),t._v(" "),s("tr",[s("td",[t._v("saveData")]),t._v(" "),s("td",[t._v("表示用户代理对减少数据使用的偏好")])])])]),t._v(" "),s("p",[t._v("注意：effectiveType并不能真正获取网络类型，而是通过综合网速来判断")]),t._v(" "),s("h3",{attrs:{id:"_6-2-监控网络状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-监控网络状态"}},[t._v("#")]),t._v(" 6.2 监控网络状态")]),t._v(" "),s("p",[t._v("通过监控window对象的online和offline事件，获取浏览器的网络状态")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'online'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'上线了'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nwindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'offline'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'掉线了'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-3-监控网络信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-监控网络信息"}},[t._v("#")]),t._v(" 6.3 监控网络信息")]),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("navigator.connection")]),t._v("对象上的"),s("code",[t._v("onchange")]),t._v("事件，监控网络信息的变化")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" connect "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconnect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"change"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'网络信息发生变化'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"六、拖拽api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六、拖拽api"}},[t._v("#")]),t._v(" 六、拖拽Api")]),t._v(" "),s("p",[t._v("拖拽对象分为拖拽目标和释放目标")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("拖拽目标")]),t._v("：鼠标按下元素，想要拖拽该元素，即被拖拽的元素")]),t._v(" "),s("li",[s("strong",[t._v("释放目标")]),t._v("：鼠标拖动拖拽目标，在目标位置松开，即释放目标")])]),t._v(" "),s("h3",{attrs:{id:"_6-1-设置元素可拖动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-设置元素可拖动"}},[t._v("#")]),t._v(" 6.1 设置元素可拖动")]),t._v(" "),s("p",[t._v("给元素添加"),s("code",[t._v('draggable="true"')]),t._v("属性")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("draggable")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-2-拖动事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-拖动事件"}},[t._v("#")]),t._v(" 6.2 拖动事件")]),t._v(" "),s("p",[t._v("在"),s("strong",[t._v("拖动目标")]),t._v("上触发事件(源元素)")]),t._v(" "),s("ul",[s("li",[t._v("此时"),s("code",[t._v("e.target")]),t._v("是拖动目标元素")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("事件")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("ondragstart")]),t._v(" "),s("td",[t._v("拖动目标"),s("strong",[t._v("开始拖动")]),t._v("时触发")])]),t._v(" "),s("tr",[s("td",[t._v("ondrag")]),t._v(" "),s("td",[t._v("拖动目标"),s("strong",[t._v("被拖动时")]),t._v("触发")])]),t._v(" "),s("tr",[s("td",[t._v("ondragend")]),t._v(" "),s("td",[t._v("拖动目标"),s("strong",[t._v("结束拖动")]),t._v("时触发")])])])]),t._v(" "),s("p",[t._v("在"),s("strong",[t._v("释放目标")]),t._v("上触发的事件")]),t._v(" "),s("ul",[s("li",[t._v("此时"),s("code",[t._v("e.target")]),t._v("是释放目标元素")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("事件")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("ondragenter")]),t._v(" "),s("td",[s("strong",[t._v("拖拽目标进入释放目标")]),t._v("时触发")])]),t._v(" "),s("tr",[s("td",[t._v("ondragover")]),t._v(" "),s("td",[s("strong",[t._v("拖拽目标在释放目标上移动")]),t._v("时触发")])]),t._v(" "),s("tr",[s("td",[t._v("ondragleave")]),t._v(" "),s("td",[s("strong",[t._v("拖拽目标离开释放目标")]),t._v("时触发")])]),t._v(" "),s("tr",[s("td",[t._v("ondrop")]),t._v(" "),s("td",[s("strong",[t._v("拖拽目在释放目标上松开鼠标")]),t._v("时触发")])])])]),t._v(" "),s("h2",{attrs:{id:"七、broadcastchannel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#七、broadcastchannel"}},[t._v("#")]),t._v(" 七、BroadcastChannel")]),t._v(" "),s("p",[s("strong",[t._v("作用")]),t._v("：跨标签页通信")]),t._v(" "),s("p",[t._v("BroadcastChannel允许同源的不同浏览器窗口，Tab 页，frame 或者 iframe 下的不同文档之间相互通信。通过触发一个 "),s("code",[t._v("message")]),t._v(" 事件，消息可以广播到所有监听了该频道的 "),s("code",[t._v("BroadcastChannel")]),t._v(" 对象。")]),t._v(" "),s("h3",{attrs:{id:"_7-1-实例化对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-实例化对象"}},[t._v("#")]),t._v(" 7.1 实例化对象")]),t._v(" "),s("p",[t._v("需要传入一个字符串作为标识符，相当于广播名，可通过实例对象的"),s("code",[t._v("name")]),t._v("属性获取")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" channel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastChannel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("channel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// demo")]),t._v("\n")])])]),s("h3",{attrs:{id:"_7-2-发送数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-发送数据"}},[t._v("#")]),t._v(" 7.2 发送数据")]),t._v(" "),s("p",[t._v("通过实例对象的"),s("code",[t._v("postmessage")]),t._v("方法发送任意类型的数据")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" channel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastChannel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nchannel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你好'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_7-3-关闭连接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-关闭连接"}},[t._v("#")]),t._v(" 7.3 关闭连接")]),t._v(" "),s("p",[t._v("通过调用 "),s("code",[t._v("BroadcastChannel.close()")]),t._v(" 方法，可以马上断开其与对应频道的关联，并让其被垃圾回收。这是必要的步骤，因为浏览器没有其他方式知道频道不再被需要。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" channel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastChannel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nchannel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_7-4-监听广播"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-监听广播"}},[t._v("#")]),t._v(" 7.4 监听广播")]),t._v(" "),s("p",[t._v("通过监听实例对象的message事件，可获取广播发送的数据")]),t._v(" "),s("p",[t._v("通过事件对象"),s("code",[t._v("e.data")]),t._v("获取数据")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" channel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastChannel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nchannel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_7-5-监听错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-5-监听错误"}},[t._v("#")]),t._v(" 7.5 监听错误")]),t._v(" "),s("p",[t._v("当频道收到一条无法反序列化的消息时会在 "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/BroadcastChannel",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("BroadcastChannel")]),s("OutboundLink")],1),t._v(" 对象上触发 "),s("code",[t._v("messageerror")]),t._v(" 事件。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("channel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'messageerror'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_7-6-封装广播工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-6-封装广播工具"}},[t._v("#")]),t._v(" 7.6 封装广播工具")]),t._v(" "),s("blockquote",[s("p",[t._v("channel.js")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 实例化广播对象")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" channel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastChannel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 发送广播")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n *\n * @param {string} type 描述信息的类型\n * @param {any} content 发送的数据\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("sendMsg")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    channel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//接收广播")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n *\n * @param {function} callback 处理接收数据的回调\n * @returns 移除监听\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("listenMsg")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("callback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handler")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        callback "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    channel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        channel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"八、声音的分析和处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#八、声音的分析和处理"}},[t._v("#")]),t._v(" 八、声音的分析和处理")])])}),[],!1,null,null,null);s.default=e.exports}}]);